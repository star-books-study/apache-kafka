# Chapter 2. 카프카 빠르게 시작해보기

## 2.1. 실습용 카프카 브로커 설치
### 2.1.1. AWS EC2 인스턴스 발급 및 보안 설정
- 주키퍼 : 분산 코디네이션 서비스 제공하는 오픈소스
  - 분산 코디네이션 서비스 : 분산 시스템 내부에 상태정보 저장 및 데이터를 Key/value 저장소로 저장 및 제공하는 서비스
- 카프카에서는 주키퍼를 **운영에 필요한 각종 설정과 상태 저장용으로 사용하고 있음**
  - 주키퍼, 브로커 : JVM 위에서 돌아가는 애플리케이션 -> 힙 메모리 지정 필요

### 2.1.3. 인스턴스에 자바 설치
- 카프카 브로커 : 스칼라와 자바로 작성되어 JVM 환경 위에서 실행된다

### 2.1.4. 주키퍼, 카프카 브로커 실행
#### 카프카 브로커 힙 메모리 설정
- 카프카 브로커는 **레코드 내용은 페이지 캐시로 시스템 메모리를 사용하고, 나머지 객체들을 힙 메모리에 저장하여 사용한다**
- 카프카 패키지의 힙 메모리는 카프카 브로커 - 1G, 주키퍼 - 512MB 로 기본 설정되어 있다
  - 힙 메모리 커스텀 지정하고 싶다면 `KAFKA_HEAP_OPTS` 환경 변수를 힙 메모리 사이즈와 함께 지정하면 된다
- 카프카 실행하기 위해 사용하는 kafka-server-start.sh 스크립트 내부에서는 `-daemon` 옵션을 사용하여 백그라운드 / 포어 그라운드 실행 여부를 결정할 수 있다
  - -daemon 을 붙일 경우 백그라운드 실행됨 -> 이 경우 실행중인 터미널 세션이 끊겨도 카프카 브로커는 계속해서 동작함
    - 일시적 카프카 브로커 테스트가 아닌 이상, **-daemon 옵션을 붙여 백그라운드로 실행하는 게 일반적인 운영 방법**